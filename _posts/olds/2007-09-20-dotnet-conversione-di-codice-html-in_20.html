---
layout: post
title: 'DotNet: conversione di codice html in testo'
date: '2007-09-20T23:56:00.001+02:00'
author: Andrea Fortuna
tags:
- VB.NET
- Programmazione
modified_time: '2012-04-26T14:21:39.195+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-8226027429654427001
blogger_orig_url: http://oldsite.andreafortuna.org/2007/09/dotnet-conversione-di-codice-html-in_20.html
---

Piccolo e utile frammento di codice che, utilizzando le amate/odiate espressioni regolari, ripulisce dai tag html il testo passato.<br/><blockquote><br/><pre><span style="color:#0000ff;">Imports</span><span style="color:#000000;"> System.Text<br/></span><span style="color:#0000ff;">Imports</span><span style="color:#000000;"> System.Text.RegularExpressions</span></pre><br/><pre><span style="color:#008000;"></span><span style="color:#008000;"><br/></span><span style="color:#0000ff;">Function</span><span style="color:#000000;"> Html2Text(</span><span style="color:#0000ff;">ByVal</span><span style="color:#000000;"> html </span><span style="color:#0000ff;">As</span><span style="color:#000000;"> </span><span style="color:#0000ff;">String</span><span style="color:#000000;">) </span><span style="color:#0000ff;">As</span><span style="color:#000000;"> </span><span style="color:#0000ff;">String</span><span style="color:#000000;"><br/> </span><span style="color:#008000;"></span><span style="color:#008000;"><br/></span><span style="color:#000000;">    </span><span style="color:#0000ff;">Dim</span><span style="color:#000000;"> repattern </span><span style="color:#0000ff;">As</span><span style="color:#000000;"> </span><span style="color:#0000ff;">String</span><span style="color:#000000;"> </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#000000;">“</span><span style="color:#000000;">\&lt;[^\&gt;]*\&gt;</span><span style="color:#000000;">“</span><span style="color:#000000;"><br/>   </span><span style="color:#0000ff;">Dim</span><span style="color:#000000;"> rexp </span><span style="color:#0000ff;">As</span><span style="color:#000000;"> </span><span style="color:#0000ff;">New</span><span style="color:#000000;"> Regex(repattern, RegexOptions.IgnoreCase)<br/></span><span style="color:#000000;"><br/></span><span style="color:#000000;">    html </span><span style="color:#000000;">=</span><span style="color:#000000;"> rexp.Replace(html, </span><span style="color:#0000ff;">String</span><span style="color:#000000;">.Empty)<br/><br/>   </span><span style="color:#0000ff;">Return</span><span style="color:#000000;"> html<br/><br/></span><span style="color:#0000ff;">End Function</span></pre><br/></blockquote>