---
layout: post
title: Apache 2.2 - Configurazione Load Balancing
date: '2006-02-26T10:59:00.002+01:00'
author: Andrea Fortuna
tags:
- Windows
- Unix
- Internet
modified_time: '2012-04-26T14:23:57.490+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-1258920332356793016
blogger_orig_url: http://www.andreafortuna.org/2006/02/apache-22-configurazione-load-balancing_4019.html
---

<p>L'ultima release del famoso WebServer porta con se alcune nuove features, tra le quali alcune modifiche al sottosistema <em>mod_proxy</em> che introducono funzionalita' di bilanciamento del carico.</p><br/><a name='more'></a><br/><p>Il nuovo <em>mod_proxy_balancer</em> permette infatti la definizione di gruppo di server all'interno di una istanza di Apache di frontend che si occupera' di bilanciare il carico 'spalmandolo' su tutto il pool e indirizzando le richieste dei client in base a due possibili criteri:</p><p><strong>Request Counting:</strong> viene preso in considerazione il numero di connessioni effettuate da ogni nodo e la richiesta viene indirizzata a quello con il numero di connessioni piu' basso.</p><p><strong>Weighted Traffic:</strong> ad esser preso in esame non e' il numero di connessioni ma il traffico effettuato su ogni nodo. Ovviamente la richiesta viene indirizzata sul nodo con meno traffico all'attivo.</p><p>La passibilita' di creare pool bilanciati permette di assorbire grosse richieste di traffico o di tempo macchina, ma anche di creare architetture ad alta affidabilita' senza pero' doversi affidare a software di clustering.</p><p>La definizione dei pool e' abbastanza semplice:</p><blockquote><p>ProxyPass / balancer://balanced_area/<br />&lt;Proxy balancer://balanced_area/&gt;<br />&nbsp;&nbsp; BalancerMember <a href="http://server_1/">http://server_1/</a><br />&nbsp;&nbsp; BalancerMember <a href="http://server_2/">http://server_2/</a><br />&nbsp;&nbsp; [...]<br />&lt;/Proxy&gt;</p></blockquote><p>Con la direttiva ProxyPass e' stato definito il frontend: alla richiesta di / rispondera' il pool di server bilanciati: ogni nuovo server di backend puo' essere aggiunto inserendo una direttiva <em>BalancedMember.</em></p><p>E' possibile inoltre definire una distribuzione del carico <em>asimmetrica</em>, utile in particolare quando le dotazioni hardware dei server in pool sono differenti:</p><blockquote><p>ProxyPass / balancer://balanced_area/<br />&lt;Proxy balancer://balanced_area/&gt;<br />&nbsp;&nbsp; BalancerMember <a href="http://server_1/">http://server_1/</a>&nbsp;max=60 smax=30 loadfactor=10<br />&nbsp;&nbsp; BalancerMember <a href="http://server_2/">http://server_2/</a>&nbsp;max=40 smax=15 loadfactor=5<br />&nbsp;&nbsp; [...]<br />&lt;/Proxy&gt;</p></blockquote><p>Il valore <em>max</em> identifica il numero di connessioni massime inviate al backend, <em>smax</em> e' utilizzato per definire un soft limit al numero di connessioni stabilite, mentre <em>loadfactor</em> assegna un 'peso' ad ogni nodo del backend.</p><p>In questo caso, <strong>server_2</strong>&nbsp;ha una potenza di calcolo inferiore rispetto a <strong>server_1</strong>, e con questa configurazione sara' possibile bilanciare correttamente il carico tra le 2 macchine.</p>