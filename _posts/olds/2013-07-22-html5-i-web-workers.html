---
layout: post
title: 'HTML5: i Web Workers'
date: '2013-07-22T09:30:00.000+02:00'
author: Andrea Fortuna
tags:
- WebWorkers
- Programmazione
- html5
modified_time: '2013-07-22T09:30:06.237+02:00'
thumbnail: http://1.bp.blogspot.com/-_-Wov1FrwKE/UeZxmeJRYGI/AAAAAAAAFYk/n-TWppnXuho/s72-c/webworkers.jpg
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-235628759801688865
blogger_orig_url: http://www.andreafortuna.org/2013/07/html5-i-web-workers.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-_-Wov1FrwKE/UeZxmeJRYGI/AAAAAAAAFYk/n-TWppnXuho/s1600/webworkers.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/-_-Wov1FrwKE/UeZxmeJRYGI/AAAAAAAAFYk/n-TWppnXuho/s200/webworkers.jpg" width="200" /></a></div>I <b><a href="http://www.w3schools.com/html/html5_webworkers.asp" target="_blank">Web Workers</a></b> nascono per consentire l’esecuzione di porzioni di codice javascript in modo asincrono: possono essere comparati a dei thread che la pagina web può lanciare e con i quali può dialogare attraverso specifici metodi.<br /><div><br />Un <i>piccolo</i> svantaggio ...i WebWorkers <b>non </b>hanno accesso al DOM: vanno visti quindi come applicazioni stand-alone per l'esecuzione di compiti impegnativi senza <i>disturbare </i>l'applicazione attuale.<br /><br /><a name='more'></a><br /><br /><h4>Un semplice WebWorker</h4><br />Vediamo come avviare un semplice thread:<br /><br /></div><pre class="brush:java">  var myWorker = new Worker('/path/operazioniDaEseguire.js');<br />    myWorker.onmessage = function(event) {<br />        console.log('Fatto, ecco i dati!', event.data);<br />    };<br /></pre><br />Niente di complicato, quindi: semplicemente eseguiamo il codice presente nel file operazioniDaEseguire.js in maniera asincrora e scriviamo sul log il dati restituiti.<br />I dati di ritorno vengono inviati al processo <i>padre</i>&nbsp;da operazioniDaEseguire.js utilizzando il comando postMessage:<br /><br /><pre class="brush:java">//operazioniDaEseguire.js<br />postMessage("Ho fatto i calcoli, la risposta alla domanda fondamentale sulla Vita, sull'Universo e tutto quanto e'...42!");<br /></pre><br /><h4>Tutto su una pagina?</h4><br />Possiamo scegliere di non utilizzare un file esterno per definire il codice del nostro worker, impacchettando tutto su una singola pagina utilizzando i <a href="https://developer.mozilla.org/en-US/docs/Web/API/Blob" target="_blank">Blob</a>.<br /><br />Dichiariamo quindi un elemento <i>&lt;script&gt;</i>&nbsp;contenente il codice da eseguire (un semplice contatore):<br /><br /><pre class="brush:java">&lt;script id="myWorker"&gt;<br />    var i = 0;<br />    setInterval(function() {<br />        i++;<br />        postMessage(i);<br />    }, 1000);<br />&lt;/script&gt;<br /></pre><br />e successivamente creiamo e avviamo &nbsp;il WebWorker a partire da un blob riempito con il contenuto dell'elemento <i>&lt;script&gt;:</i><br /><br /><pre class="brush:java">var workerData = new Blob([document.getElementById('myWorker').textContent], {<br />    type: "text/javascript"<br />});<br /><br />myWorker = new Worker(window.URL.createObjectURL(workerData));<br />    myWorker.onmessage = function (e) {<br />        console.log('Conto...', event.data);<br />    };</pre><br /><h4>Mettiamo tutto insieme</h4><br />Vediamo l'esempio completo:<br /><br /><iframe allowfullscreen="allowfullscreen" frameborder="0" height="300" src="http://jsfiddle.net/AndyFor/VdEzw/embedded/result,js,html/" width="100%"></iframe>