---
layout: post
title: 'HTML5: utilizzare l''oggetto canvas per applicare il watermark sulle immagini'
date: '2013-05-24T12:07:00.000+02:00'
author: Andrea Fortuna
tags:
- Programmazione
- html5
- canvas
modified_time: '2013-06-04T10:11:53.158+02:00'
thumbnail: http://1.bp.blogspot.com/-NQ2KO52hP9A/UZomqkBE9MI/AAAAAAAAEv0/PKAEfpuhTEo/s72-c/HTML5_logo.svg.png
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-1441838169274602077
blogger_orig_url: http://oldsite.andreafortuna.org/2013/05/html5-utilizzare-loggetto-canvas-per.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-NQ2KO52hP9A/UZomqkBE9MI/AAAAAAAAEv0/PKAEfpuhTEo/s1600/HTML5_logo.svg.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/-NQ2KO52hP9A/UZomqkBE9MI/AAAAAAAAEv0/PKAEfpuhTEo/s200/HTML5_logo.svg.png" width="200" /></a></div>Nel <a href="http://oldsite.andreafortuna.org/2013/05/html5-accedere-alla-videocamera-e-alla.html" target="_blank">precedente articolo</a>, ho spiegato come acquisire immagini da fotocamera/galleria dello smartphone utilizzando esclusivamente funzionalità di <a href="http://oldsite.andreafortuna.org/search/label/html5" target="_blank">HTML5</a>.<br /><br /><br />Oggi mi riallaccio allo stesso argomento e lo estendo, proponendo un semplice script che oltre ad acquisire l'immagine le applica un watermark.<br /><br />Per lo scopo utilizzo l'oggetto <a href="http://www.w3schools.com/html/html5_canvas.asp" target="_blank">CANVAS</a>, che permette di 'disegnare' sulla pagina web, e al suo interno carico prima l'immagine scelta alla quale poi sovrappongo il watermark (righe 27-43).<br /><br /><a name='more'></a><br />Per migliorare la visualizzazione sul display del terminale, prima di tutto ridimensiono il canvas utilizzando le proporzioni dell'immagine caricata. (righe 34-36)<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-I3jMKhd4koM/UZ85pDvihdI/AAAAAAAAFK8/QHEUNuB4ag8/s1600/IMG_0091%5B1%5D.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-I3jMKhd4koM/UZ85pDvihdI/AAAAAAAAFK8/QHEUNuB4ag8/s640/IMG_0091%5B1%5D.PNG" width="426" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><br />Di seguito il codice:<br /><br /><script src="https://gist.github.com/andreafortuna/94130340f9023c759d09.js"></script> <br />L'immagine generata potrà essere poi 'estratta' dal canvas con questo codice:<br /><br /><pre class="brush: java">var data = canvas.toDataURL('image/png');<br /></pre><br />che restituisce l'immagine sotto forma di stringa in <b>base64 </b>(<i>data:image/png;base64,...</i>): se caricata su un server remoto, sarà sufficiente rimuovere il prefisso "<i>data:image/png;base64,", </i>effettuare la decodifica da base64 e salvare il risultato su file.<br /><br /><b>UPDATE 04/06/2013</b>: dopo aver letto <a href="https://plus.google.com/110231830066114329709/posts/YPbxBDTtT8o" target="_blank">questa discussione su G+</a>, ho rimesso mano allo script, rendendolo compatibile anche con Firefox (riga 25). Grazie a tutti per le segnalazioni.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://demo.andreafortuna.org/HTML5ImageWatermark/" imageanchor="1" style="margin-left: 1em; margin-right: 1em;" target="_blank"><img border="0" src="http://4.bp.blogspot.com/--a636JhrqsA/UaxSqfKXRkI/AAAAAAAAFNU/YBpXvRkMxA4/s1600/DEMO.png" /></a></div><br /><br /><br />Buon divertimento!