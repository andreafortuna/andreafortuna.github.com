---
layout: post
title: Decompilare una applicazione Asp.Net
date: '2010-06-16T10:26:00.001+02:00'
author: Andrea Fortuna
tags:
- Programmazione
- ASP.NET
modified_time: '2013-06-07T11:33:05.726+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-7343837621949395768
blogger_orig_url: http://oldsite.andreafortuna.org/2010/06/decompilare-una-applicazione-aspnet_16.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://imgs.xkcd.com/comics/flowchart.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="http://imgs.xkcd.com/comics/flowchart.png" width="179" /></a></div>Mi è capitato di recente di ricevere una richiesta particolare: realizzare una piccola modifica ad una applicazione web realizzata in asp.net. L'applicazione in questione era stata rilasciata compilata e senza i sorgenti acclusi.<br />Dopo una breve indagine, la cosa si riviera meno semplice del previsto: il collega che si occupò della realizzazione del progetto ha smarrito i sorgenti (argh!).<br /><br />Che fare quindi? Riscrivere da capo l'applicazione? Nooooo! Decompiliamo la versione attualmente in produzione! :-)<br /><br /><a name='more'></a><br /><br />Per prima cosa, diamo uno sguardo a cosa ci troviamo tra le mani: anziche' avere, come in fase di sviluppo del progetto, ad ogni pagina .ascx un corrispondente file contenente il codebehind (.ascx.vb o .ascx.cs), in una applicazione compilata e' presente solamente il file .ascx, che a sua volta 'pesca' codice da un assembly posizionato nel folder <strong>Bin</strong>, nella root dell'applicazione.<br /><br />Nell'intestazione della nostra pagina troveremo quindi qualcosa del genere:<br /><br /><pre class="brush:xml">&lt;%@ page language="vb" masterpagefile="~/MasterPage.master" autoeventwireup="false" inherits="applicazione._default, App_Web_js57z-yx" smartnavigation="False" stylesheettheme="MyTheme" %&gt;<br /></pre><br /><br />La proprieta' <em>Inherits </em>ci fornisce il nome dell'assembly che contiene il codebehind della pagina (in questo caso <strong>App_Web_js57z-yx.dll</strong>).<br />A questo punto abbiamo tutte le informazioni che ci servono, iniziamo a decompilare.<br />Scarichiamo quindi un decompilatore per .net: personalmente uso <a href="http://www.red-gate.com/products/reflector/">Reflector</a>, la versione base e' gratuita e sembra fare il suo lavoro senza grossi problemi.<br /><br />Una volta installato, diamo in pasto a reflector l'assembly identificato leggendo l'intestazione della pagina (<strong>App_Web_js57z-yx.dll</strong>), poi click di tasto destro sul nome apparso nell'elenco e selezionate 'Export':<br /><div style="text-align: center;"></div><br /><div style="text-align: left;"><em>Reflector </em>a questo punto salvera' un folder contenente il sorgente estratto dall'assembly: assieme ad alcune dipendenze che, troverete anche il file contenente il codebehind della pagina:</div><br /><div style="text-align: left;"><a href="http://andreafortuna.files.wordpress.com/2010/06/reflector.jpg" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img alt="" class="size-medium wp-image-1292 aligncenter" height="229" src="http://andreafortuna.files.wordpress.com/2010/06/reflector.jpg?w=300" title="reflector" width="300" /></a><a href="http://andreafortuna.files.wordpress.com/2010/06/reflector2.jpg"><img alt="" class="aligncenter size-full wp-image-1293" height="134" src="http://andreafortuna.files.wordpress.com/2010/06/reflector2.jpg" title="reflector2" width="251" /></a></div><div style="text-align: left;"><br /></div><div style="text-align: left;">Ci rimane da effettuare una ultima, semplicissima operazione: copiamo il file generato da reflector nella stessa directory contenente il corrispondente .ascx, rinominiamo il nostro file con la sintassi standard (nel nostro esempio default.ascx.vb oppure default.ascx.cs) e modifichiamo in questo modo l'intestazione della pagina:</div><br /><pre class="brush:xml">&lt;%@ page language="vb" masterpagefile="~/MasterPage.master" autoeventwireup="false" inherits="_default" CodeFile="~/default.aspx.vb" smartnavigation="False" stylesheettheme="MyTheme" %&gt;<br /></pre><br />Compiliamo il progetto e prendiamo nota delle dipendenze che non vengono soddisfatte: ripetiamo quindi questa procedura per i rimanenti file fino a risolvere tutte le dipendenze mancanti.<br /><br />Infine, ricontrolliamo il codice verificando che tutti gli eventi dei controlli siano 'collegati' nel codebehind: in caso contrario sara' necessario specificare l'handle dell'evento alla <em>sub </em>corrispondente.