---
layout: post
title: 'Pillole di Computer Forensics: Acquisire i dati'
date: '2005-12-27T12:12:00.001+01:00'
author: Andrea Fortuna
tags:
- Security
modified_time: '2012-04-26T14:24:31.214+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-9160244451410558310
blogger_orig_url: http://oldsite.andreafortuna.org/2005/12/pillole-di-computer-forensics-acquisire_27.html
---

<p>Una <em>copia forense</em> deve essere una copia "bit-a-bit" dell'intero disco (fisico o virtuale, se <em>spalmato</em> su un RAID), comprendente l'MBR e la partition table.</p><p>La copia va quindi effettuata direttamente sul device che identifica il disco (Es. /dev/hda) e non sulle singole partizioni.</p><a name='more'></a><p>La copia inoltre non deve essere sottoposta e nessun tipo di compressione: programmi come il Norton Ghost effettuano la compressione dello spazio libero, con il risultato di non poter recuperare file cancellati prima del <em>dump</em> dell'immagine.</p><p>La legislazione italiana attualmente e' abbastanza carente per quanto riguarda la certificazione delle copie e dei software utilizzabili per realizzarle. Per questo conviene dare uno sguardo oltreoceano, dove le agenzie statunitensi hanno  certificato un ristretto gruppo di tool, quasi tutti software commerciali o costosi duplicatori hardware.</p><p>L'unico software OpenSource certificato e' <strong>dd</strong>, che se da un lato utilizza una formato <em>raw</em> che puo' essere letto dalla maggior parte dei software commerciali e non, dall'altro non ha (a differenza delle controparti commrciali) alcun sistema di certificazione della copia.</p><p>A questa mancanza si puo' supplire tranquillamente con tools come <em>md5sum</em> e <em>sha1</em>: entrambi sono accettati in ambito forense.</p><p>Iniziamo ora ad acquisire i dati.</p><p><strong>Isolamento</strong></p><p>Per prima cosa isolare  le macchine dalla rete, spegnendo eventualmente gli switch/hub.</p><p>Se le macchine da controllare sono ancora accese, verificare che non ci sia attivita' dei dischi e staccare le alimentazioni: non e' uno shutdown <em>regolare</em>, ma e' il modo migliore per preservare lo status quo.</p><p>Riaccendere poi la macchina e entrare nel bios: verificare eventuali scostamenti di data/ora rispetto al nostro punto di riferimento e modificare l'ordine di boot in modo da far avviare il sistema esclusivamente da cd-rom.</p><p><strong>Boot</strong> </p><p>A questo punto entra in scena uno dei nostri tool: la distribuzione <em>live</em> di linux. Personalmente utilizzo la strafamosa <em>Knoppix</em>: il supporto hardware e' ottimo.</p><p>Effettuato quindi il boot da CD-ROM, si puo' montare il disco della macchina in read-only per dare uno sguardo all'interno, eventualmente per redigere immediatamente una bozza di prospetto sui software inistallati.</p><p><strong>Acquisizione</strong> </p><p>Il mio kit per l'acquisizione dei dati consiste in un portatile con installato linux (debian sarge), con un hard disk sufficentemente capiente e una scheda di rete veloce.La procedura e' semplice:</p><ol><li>Collegare il portatile alla macchina da analizzare con un cavo <em>crossed</em>, configurare correttamente i parametri di rete sul laptop e sulla knoppix</li><li>Avviare la copia via rete con <em>netcat</em> e <em>dd:</em></li></ol><p>Sul laptop (server):</p><blockquote><p>netcat -l -p numeroporta &gt; file-immagine</p></blockquote><p>Sulla macchina da analizzare (client)</p><blockquote><p>dd if=device_da_acquisire bs=2048 | netcat ip-del-laptop numeroporta</p></blockquote><p>Per scongiurare problemi in fase di verifica della copia e' consigliato seguire questi passi:</p><ul><li><div>Attendere il messaggio di fine copia sul client</div></li><li><div>Verificare l'effettiva assenza di attivita' di rete</div></li><li><div>Interrompere il client con CTRL-C (a quel punto il server uscira' automaticamente)</div></li><li><div>Lanciare il comando <em>sync</em> sul server in modo da svuotare la cache del filesystem</div></li><li><div>Verificare origine e destinazione con il tool di hashing scelto.</div></li></ul><p><strong>Verifica dei dati</strong></p><p>Gli algoritmi di hash ci sono utili per verificare la fedelta' dei dati acquisiti e l'inalterbilita' dei dati nel corso del tempo: riapplicando in qualsiasi momento l'algoritmo ai dati acquisiti si potra' verificare che non sono stati modificati nel corso dell'indagine.</p><p>L'utilizzo e' semplicissimo:con</p><blockquote><p>md5sum immagine-acquisita</p></blockquote><p>otterremo l'hash dell'immagine appena acquisita mentre, eseguando sul client (sempre con Knoppix)</p><blockquote><p>md5sum /dev/deviceacquisito</p></blockquote><p>ci verra' restituito l'hash del disco.</p><p>Per certificare la corretta copia, i due valori devono essere (manco a dirlo!) uguali.</p><p>In ultimo, tutte le operazioni effettuate e tutti gli hash dovranno essere annotati sul verbale di acquisizione.</p>