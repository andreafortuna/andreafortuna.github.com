---
layout: post
title: Pillole di Ajax
date: '2005-12-08T08:12:00.001+01:00'
author: Andrea Fortuna
tags:
- Programming
modified_time: '2012-04-26T14:24:31.189+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-8228249105541590409
blogger_orig_url: http://oldsite.andreafortuna.org/2005/12/pillole-di-ajax_07.html
---

<p><strong>AJAX</strong> o <strong>Asynchronous JavaScript and XML</strong> è una tecnica per sviluppare applicazioni web interattive e dinamiche usando una combinazione di:</p><ul><li>HTML e CSS per la parte visiva </li><li>DOM (Document Object Model) modificato attraverso JavaScript per mostrare dinamicamente le informazioni e interagirci </li><li>L'oggetto XMLHttpRequest per interscambiare e manipolare dati in modo asincrono tra il browser dell'utente e il web server.</li></ul><p>La potenzionalita' di una tecnologia del genere risiede nella possibilita' di modificare/aggiornare/ricaricare singole parti del documento html evitando pero' il caricamento dell'intera pagina.</p><p>Le applicazioni web che usano AJAX richiedono browser che supportano le tecnologie sopraelencate. Questi browser includono: Mozilla, FireFox, Internet Explorer, Opera, Konqueror e Safari.</p><p>Proviamo ora a sviluppare una semplice pagina HTML/Javascript che utilizzi la tecnologia asincrona.</p><a name='more'></a><p>Per prima cosa, realizziamo un file .js, con all'interno tutte le funzioni di cui avremo bisogno e che includeremo poi nel documento html.</p><p>La prima funzione sara' quella necessaria a instanziare l'oggetto XMLHttpRequest, in un certo senso il cuore della nostra applicazione:</p><blockquote><p>/** * Funzione che istanzia un oggetto XMLHttpRequest usando un meccanismo cross browser. * * @return   restituisce un'istanza di XMLHttpRequest oppure il valore false in caso *           di errori. */</p><p>function getXMLHttpRequestInstance() {</p><p>    var xmlhttp;</p><p>    // Prova il metodo Microsoft usando la versione più recente:    try {        xmlhttp = new ActiveXObject("Msxml2.XMLHTTP");    } catch (e) {</p><p>        try {            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");        } catch (E) {            xmlhttp = false;        }    }</p><p>    // Se non è stato possibile istanziare l'oggetto forse siamo    // su Mozilla/FireFox o su un altro browser compatibile:    if (!xmlhttp &amp;&amp; typeof XMLHttpRequest != 'undefined') {        try {            xmlhttp = new XMLHttpRequest();        } catch (e) {            xmlhttp = false;        }    }</p><p>    // Restituisce infine l'oggetto:    return xmlhttp;}</p></blockquote><p>In seguito avremo bisogno di una funzione che si occupi di modificare parti della pagina HTML:</p><blockquote><p>/** * Funzione che sostituisce il contenuto HTML di un nodo della pagina. * * @param    nodeId ID del nodo * @param    html   codice HTML da sostituire a quello del nodo */function updateContent(nodeId, html) {       var node = document.getElementById(nodeId);    if(null == node) {  //alert("[ERRORE] L'elemento " + nodeId + " non esiste");  return;    }    node.innerHTML = html;    node.style.visibility = "visible";}</p></blockquote><p>In ultimo una funzione (sara' quella realmente utilizzata) che si occupera' di richiamare <em>getXMLHttpRequestInstance() </em>per instanziare l'oggetto, utilizzarlo per richiedere dati al webserver e richiamare <em>updateContent(nodeId, html)</em> per aggiornare un elemento della pagina con i dati ricevuti:</p><blockquote><p>/** * Richiede al web server il contenuto di una pagina (testo o HTML) in maniera asincrona. * @param    nodeId    ID dell'elemento della pagina che conterrà la slide * @param    url       URL della slide (deve essere sullo stesso server per motivi di sicurezza) */function LoadElement(nodeId, url) {    var xmlhttp = getXMLHttpRequestInstance();    if(!xmlhttp) {        alert("Il browser non supporta l'oggetto XMLHttpRequest");        return false;    }        updateContent(nodeId,"");    updateContent(nodeId,"<br /><strong>...Caricamento in corso...</strong><br />"); </p><p>    xmlhttp.open("GET", url,true);    xmlhttp.onreadystatechange=function() {        if (xmlhttp.readyState==4) {            if (xmlhttp.status==200) {                updateContent(nodeId, xmlhttp.responseText);            } else if (xmlhttp.status==404) {                alert("[ERRORE] l'URL "+url+"non esiste!");            } else {                alert("[ERRORE] errore non gestito (" + xmlhttp.status + ")");            }        }    }    xmlhttp.send(null);}</p></blockquote><p>A questo punto salviamo le tre funzioni in un file (ad esempio ajax.js) e proviamo a realizzare una pagina HTML con tecnologia <em>asincrona</em>:</p><blockquote><p></p><p>         AJAX Test         </p><p>         oldsite.andreafortuna.net" onclick="javascript:LoadElement('elemento','http://oldsite.andreafortuna.net')"&gt;      <div></div></p><p>   </p><p></p></blockquote><p>Per prima cosa includiamo nella pagina il file ajax.js appena creato, in seguito creiamo un bottone e associamo all'evento OnClick la funziona LoadElement, alla quale passiamo l'ID del nodo da aggiornare (dichiarato alla riga successiva) e l'indirizzo dei dati da utilizzare per l'aggiornamento.</p><p>In questo modo, al click del pulsante, viene caricata l'HomePage di andreafortuna.net (giustamente <em>spogliata</em> dai fogli di stile, che non vengono scaricati).</p><p><a href="http://oldsite.andreafortuna.net/files/AJAX_DEMO/" target="_blank">CLICCA QUI PER VEDERE L'APPLICAZIONE IN FUNZIONE</a></p><p><!--adsense--></p>