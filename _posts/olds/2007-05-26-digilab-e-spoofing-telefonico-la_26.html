---
layout: post
title: 'Digilab e Spoofing telefonico: la scoperta dell''acqua calda!'
date: '2007-05-26T12:51:00.001+02:00'
author: Andrea Fortuna
tags:
- Hacking
- Telefonia
modified_time: '2012-04-26T14:21:52.741+02:00'
blogger_id: tag:blogger.com,1999:blog-1948348952555789070.post-5733722096683948087
blogger_orig_url: http://www.andreafortuna.org/2007/05/digilab-e-spoofing-telefonico-la_26.html
---

Da qualche giorno sta <a href="http://www.thebloggers.eu/2007/05/26/come-falsificare-una-telefonata.html">girando sui blog</a> un video di un'intervista a Alessandro Marzini (Digilab), trasmessa da Sky Tg 24 dove lo stesso Marzini parla della scoperta di una "<em>grossa falla nel sistema telefonico che permette di falsificare il mittente di una chiamata</em>".<br/><br/><object height="350" width="425"><br/>      <param name="movie" value="http://www.youtube.com/v/MCKHAlV8U5c"><br/>      <param name="wmode" value="transparent"><br/>      <embed src="http://www.youtube.com/v/MCKHAlV8U5c;rel=0" type="application/x-shockwave-flash" wmode="transparent" height="350" width="425"><br/>      </object><br/><br/>La notizia e' rimbalzata poi anche su <a href="http://punto-informatico.it/p.aspx?id=1995838">Punto-Informatico</a>, che ha pubblicato una ulteriore intervista.<br/><br/>Beh, piu' o meno e' come se un giorno pubblicassi sul mio blog la notizia a caratteri cubitali <strong>"<em>Scoperta Grossa Falla nel protocollo SMTP: e' possibile inviare mails con l'indirizzo di un'altra persona!"</em> </strong>:-D<br/><br/>Con l'avvento della tecnologia VoIp, la modifica del CallerId e'  diventata infatti accessibile a chiunque: basta mettere in piedi un proprio server Asterisk, agganciarsi a un provider Voip che fornisca una certa liberta' di configurazione (purtroppo quelli 'free', come VoipStunt e altri non lo permettono) e inviare chiamate con il CallerID desiderato.<br/>Il CLI infatti altro non e' che un dato inviato da un terminale a un'altro sulla rete (piu' o meno come il 'mail-from' negli header delle email).<br/>Cito infatti <a href="http://it.wikipedia.org/wiki/Caller_ID">WikiPedia</a>:<br/><blockquote>Il termine <strong>Caller ID</strong>, CLID (Calling Line IDentifier) o CLI, viene utilizzato in telefonia per identificare il numero telefonico dell'utente chiamante.<br/><br/>Per poter visualizzare il numero del chiamante, il ricevente deve avere un telefono compatibile CLIP (CLI Present) e una linea telefonica abilitati a ricevere l'informazione. In Italia, su linea fissa, il servizio è disponibile opzionalmente su tutte le linee <a href="http://it.wikipedia.org/wiki/PSTN" title="PSTN">PSTN</a> mentre è un servizio incluso nel canone di abbonamento delle linee <a href="http://it.wikipedia.org/wiki/ISDN" title="ISDN">ISDN</a>. La ricezione del CLI è abilitata in automatico su tutte le linee mobili.<br/><br/><em>La visualizzazione del CLI è soggetta anche alle impostazioni dell'utente chiamante, a questo infatti è data la possibilità di impedire al destinatario della chiamata di visualizzare il proprio numero.</em> Questa funzionalità è comunque limitata e non vale in caso di chiamata a numeri di emergenza pubblica o a numeri verdi.<br/><br/>Il Caller ID è utilizzato in alcuni casi come identificativo dell'utente chiamante per garantire l'accesso a sistemi riservati (esempio significativo è quello delle segreterie telefoniche che permettono la telelettura dei messaggi) tuttavia questo metodo di autenticazione è dimostrato essere molto vulnerabile. <em>Su Internet esistono infatti molti siti che permettono a qualsiasi utente di chiamare facendo sì che al destinatario venga visualizzato un CLI a scelta.</em></blockquote><br/>E di questo se n'e' parlato abbondantemente, a partire dal <a href="https://www.defcon.org/images/defcon-12/dc-12-presentations/Lucky225-Carlson/dc-12-lucky225.zip">talk tenuto da Lucky225</a>  al Defcon 12 del 2004.<br/><br/>Girando su internet, poi, ci si imbatte in chi ha realizzato addirittura uno <a href="http://nata2.org/2006/02/14/caller-id-spoofing-with-php-and-asterisk/">script per asterisk</a> che permette, chiamando un numero registrato sul pbx, di digitare il numero dal quale si vuole far partire la telefonata, il numero da chiamare e poi far partire la chiamata con il callerID 'spoofato', il tutto in pochissime righe di codice:<br/><blockquote><span style="font-style:italic;">//(step 1) Prompt user for input</span><br/>$agi-&gt;stream_file(’enter_spoof’); <span style="font-style:italic;">//(step 2) Grab 10 digits</span><br/>$result = $agi-&gt;get_data(’beep’, 3000, 10);<br/><span style="font-style:italic;">//set variables and output debug info</span><br/>$spoofnumber= $result[’result’];<br/>$agi-&gt;verbose(”Spoof Number:”.$spoofnumber);<br/><br/><span style="font-style:italic;">//(step 3) Prompt user for input</span><br/>$agi-&gt;stream_file(’call_spoof’);<br/><span style="font-style:italic;">//(step 4) Grab 10 digits</span><br/>$result = $agi-&gt;get_data(’beep’, 3000, 10);<br/><span style="font-style:italic;">//set variables and output debug info</span><br/>$callnumber= $result[’result’];<br/>$agi-&gt;verbose(”Number to call:”.$callnumber);<br/><br/><span style="font-style:italic;">//(step 5) Set callerid to whatever the input was in step 2</span><br/>$agi-&gt;set_callerid($spoofnumber);<br/><span style="font-style:italic;">//(step 6) Make call to number from input in step 3 and 4<br/>$agi-&gt;exec(”Dial IAX2/yourpassword@provider/1″.$callnumber);</span></blockquote><br/>E se non sbaglio nel video tanto discusso Marzini digita un numero, attende un segnale, poi digita un'altra serie di caratteri: a occhio e croce, segue proprio i passi dettati dallo script citato qualche riga fa.<br/><br/>In ultimo, esistono provider Voip commerciali che forniscono nativamente la modifica del CallerID: uno tra tutti <a href="http://www.voicetrading.com">Voicetrading.com</a><strong>, </strong>della Betamax (la stessa di VoipStunt e VoipBuster),  servizio a pagamento dedicato esclusivamente alle aziende con partita IVA.<br/><br/>Concludendo, a mio avviso ci si trova davanti a una classica NON notizia,  come le tante che i nostrani giornalisti partoriscono quando tentano di affrontare argomenti tecnici senza averne le basi: la 'falla' in questione esiste da sempre , nessuno l'ha mai tenuta nascosta, quindi anche la 'scoperta' e' una NON scoperta! :-D<br/><br/>Il buon  Alessandro Marzini, dal canto suo, ha cavalcato l'onda probabilmente con l'idea di fare un po' di pubblicita' alla Digilab; e infatti conclude l'intervista con una frase sibillina:<br/><blockquote>noi non abbiamo inventato nulla ma semplicemente scoperto qualcosa che, non saprei dire da quando, qualcuno ha utilizzato ed utilizza quotidianamente alle spalle delle gente e delle istituzioni; <strong>per questo, ci dichiariamo a disposizione di chiunque - magistratura, forze dell'ordine, avvocati, cittadini - ritenesse di dover approfondire un argomento di attualità così delicata e, perché no, anche di collaborare con gli Operatori telefonici ed offrire le nostre conoscenze.</strong></blockquote><br/>(Gratis, vero?)