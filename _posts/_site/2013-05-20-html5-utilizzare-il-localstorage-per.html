<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-NQ2KO52hP9A/UZomqkBE9MI/AAAAAAAAEv0/PKAEfpuhTEo/s1600/HTML5_logo.svg.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="200" src="http://1.bp.blogspot.com/-NQ2KO52hP9A/UZomqkBE9MI/AAAAAAAAEv0/PKAEfpuhTEo/s200/HTML5_logo.svg.png" width="200" /></a></div>Tra le nuove funzionalità introdotte da <a href="http://oldsite.andreafortuna.org/search/label/html5" target="_blank">HTML5</a>, il <a href="http://oldsite.andreafortuna.org/search/label/localstorage" target="_blank"><i>localStorage</i> </a>(assieme al suo corrispettivo a 'breve termine' <i>sessionStorage</i>) è una delle più comode:&nbsp;offre infatti la possibilità di salvare dati relativi a una determinata applicazione web all’interno del database del browser.<br /><br /><br />Molto più completo dei Cookie, sia in termini di dimensioni (5Mb) sia in termini di carico del server (genera molto meno traffico), ha una grossa limitazione: può archiviare in maniera efficace solamente strutture dati 'semplici', come stringhe o numeri.<br /><br /><a name='more'></a><br /><br />Se si prova infatti a effettuare un'operazione del genere<br /><pre class="brush: java">var array1 = new Array("Primo", "Secondo", "Terzo");<br />window.localStorage.setItem("cachedArray", array1);<br /></pre><br />l'archiviazione fallisce.<br /><br /><br /><br />La soluzione più rapida è serializzare l'oggetto da archiviare (nel nostro caso un array) e trasformarlo in una stringa JSON:<br /><br /><pre class="brush: java">var array1 = new Array("Primo", "Secondo", "Terzo");<br />window.localStorage.setItem("cachedArray", JSON.stringify(array1));<br /></pre><br />e in questo modo i nostri dati vengono salvati in maniera corretta.<br /><br />Quando andremo a rileggerli, utilizzeremo il procedimento inverso:<br /><br /><pre class="brush: java">var array2 = JSON.parse(window.localStorage.getItem("cachedArray"));<br /></pre><br />Possiamo anche rendere il tutto ancora più comodo e trasparente, estendendo l'oggetto <i>Storage </i>:<br /><br /><pre class="brush: java">Storage.prototype.setArray = function(key, obj) {<br />    return this.setItem(key, JSON.stringify(obj))<br />}<br />Storage.prototype.getArray = function(key) {<br />    return JSON.parse(this.getItem(key))<br />}<br /></pre><br /><span style="font-size: x-small;"><i>(ringrazio <a href="http://inflagrantedelicto.memoryspiral.com/2013/05/phonegap-saving-arrays-in-local-storage/" target="_blank">Joseph Labrecque</a> per il suggerimento)</i></span><br /><br /><br />In questo modo aggiungiamo all'oggetto storage due nuovi metodi, <b><i>setArray </i></b>e <b><i>getArray </i></b>che potremo utilizzare rispettivamente per salvare e leggere array dal <i>localStorage </i>o dal <i>sessionStorage</i>, in questo modo:<br /><br /><br /><pre class="brush: java">//SET<br />var array1 = new Array("Primo", "Secondo", "Terzo");<br />window.localStorage.setArray("cachedArray", array1);<br /><br />//GET<br />array1 = window.localStorage.getArray("cachedArray");<br /></pre>