<strong>Alternate Data Streams</strong>: ultimamente se ne sente parlare un po' piu' spesso per via di alcuni virus/trojan che li utilizzando per 'nascondersi', ma cosa sono?<br/><br/>Gli <em>Alternate Data Streams</em> (da ora ADS) sono una categoria di oggetti disponibili esclusivamente su filesystem NTFS, ben noti agli addetti ai lavori ma molto meno in vista all'utente finale, data la totale mancanza di un tool nativo interno a Windows utile per manipolarli.<br/>Per spiegare di che categoria di oggetti si tratta partiamo da NTFS: in questo tipo di filesystem le informazioni riguardanti file e cartelle sono memorizzati in una speciale tabella presente sul disco chiamata <strong>Master File table</strong> (<strong>MFT</strong>).<br/>In questa tabella le informazioni sono archiviate in una serie di oggetti chiamati 'attributi', assegnati in numero variabile al file o alla cartella.<br/>Tra questi possiamo trovare ad esempio il nome assegnato al file, la sua data di creazione, la data dell'ultima modifica, i descrittori di protezione e naturalmente i dati contenuti.<br/><br/>Ora, in NTFS e' possibile associare a ogni singolo file piu' attributi, contenenti le informazioni piu' disparate: al cosidetto 'flusso dati principale' (il contenuto del file) e' possibile associare <em>n</em> 'flussi dati alternativi' (da qui il nome) contenenti ulteriori informazioni, e soprattutto totalmente invisibili all'utente.<br/><br/>Nati per far mantenere a windows compatibilita' con i sistemi macintosh basati su HFS (che include nativamente un sistema simile) e permettergli quindi di operare come fileserver per essi, con l'avvento di Window 2000 sono stati utilizzati in maniera piu' ampia, dando la possibilita' all'utente di memorizzare una serie di informazioni relative ai files (autore, oggetto, date di modifica ecc...) normalmente accessibili dalla scheda <em>Riepilogo</em> delle proprieta' del file.<br/><br/>E qui' viene il bello: non ci sono limitazioni di dimensioni dell'ADS associato al file, ne di tipologia di allegato (nessuno vieta di inserire un file eseguibile!); le dimensioni del file visualizzate dal sistema saranno sempre quelle relative al flusso principale, a prescindere dalle dimensioni degli ADS associati (sarebbe teoricamente possibile saturare un disco con un  file da 2Kb, ma con 4 Gb di ADS!).<br/><br/>Come ho gia' detto, windows non ha <em>nativamente</em> tools per la manipolazione dei flussi dati alternativi, tuttavia e' possibile effettuare un minimo di operazioni utilizzando il prompt dei comandi e il notepad (!) :-)<br/><br/>Ogni ADS viene identificato tramite un nome  a seguire il nome del file che lo contiene, ad esempio<br/><blockquote>pippopaperino.txt:pluto.txt</blockquote><br/>identifica il flusso dati alternativo <em>pluto.txt</em> presente all'interno del file pippopaperino.txt.<br/><br/>Possiamo creare un ADS digitando dal prompt dei comandi<br/><blockquote>echo Testo di prova &gt; pippopaperino.txt:pluto.txt</blockquote><br/>in questo modo inseriamo nel file pippopaperino.txt (precedentemente creato con il notepad) il flusso alternativo pluto.txt, contenente la frase 'Testo di prova'.<br/><br/>Possiamo poi visualizzare l'ADS appena creato digitando<br/><blockquote>notepad pippopaperino.txt:pluto.txt</blockquote><br/>magicamente, invece di visualizzare il contenuto di <em>pippopaperino.txt</em>, il notepad ci presentera' il contenuto del flusso alternativo <em>pluto.txt</em>.<br/><br/>Se volessimo copiare un file all'interno di un ADS lo potremmo fare con<br/><blockquote>type fileditesto.txt &gt; pippopaperino.txt:altrofile.txt</blockquote><br/>e nessun ci vieta nemmeno di effettuare la stessa operazione con un file eseguibile:<br/><blockquote> type notepad.exe &gt; pippopaperino.txt:blocconote.exe</blockquote><br/>che una volta inserito potra' essere lanciato con<br/><blockquote>start  .\pippopaperino.txt:blocconote.exe</blockquote><br/>E' interessante notare che solo il TaskManager di windowsXp informa che il file in esecuzione e' un flusso alternativo: windows 2000 visualizza esclusivamente il nome del file che lo contiene! :-)<br/><br/>Altro particolare inquietante e' che non e' possibile (sempre tramite i tools forniti con windows) rimuovere un ADS da un file se non cancellandolo (magari salvando prima il flusso dati principale del file stesso).<br/>Considerando che e' possibile aggiungere un ADS anche alla cartella in cui ci si trova con il comando<br/><blockquote> echo Testo di prova &gt; :pluto.txt</blockquote><br/>mi vien da pensare che se si esegue un comando del genere nella root di C: non ci sarebbe altro modo di rimuovere quanto inserito se non formattando il disco!<br/><br/>Fortunatamente esistono software di terze adatti a manipolare gli ADS, uno dei quali distribuito dalla stessa Microsoft: <a href="http://download.microsoft.com/download/F/C/6/FC6943EB-790A-44AA-B32D-14ED7E22FD5D/NTFSExt.exe">NTFS ext</a><br/><br/>Una volta installato, aggiunge alla finestra delle proprieta' del file una nuova scheda chiamata <strong>Streams </strong>dalla quale possiamo visionare e cancellare gli <em>alternate data streams</em> legati al file.<br/><br/>Riassumendo, gli ADS sono indubbiamente utili, permettendo una migliore organizzazione dei files e delle cartelle; tuttavia possono essere utilizzati per scopi meno leciti, come ad esempio:<br/><ul><br/>	<li>utilizzati da virus e trojan per nascondersi a gli occhi dell'utente (per fortuna i principali antivirus/antispyware supportano lo scanning degli ads)</li><br/>	<li>usati per attacchi DenialOfService, saturando un filesystem apparentemente vuoto.</li><br/>	<li>riempiti con materiale illecito che deve essere nascosto da occhi indiscreti</li><br/>	<li>utilizzati per archiviare programmi poi eseguiti sotto 'falso nome' (solo su sistemi precedenti a WindowsXP).</li><br/></ul>