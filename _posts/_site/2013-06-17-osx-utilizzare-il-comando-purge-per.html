<b>UPDATE 30/10/2013: lo script non e' utilizzabile (e necessario, vista la nuova gestione della memoria) su <i>OSX Mavericks</i>.&nbsp;</b><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-IFs3ToozUkw/UbCH9IB63LI/AAAAAAAAFQA/OWfeqgC1nH0/s1600/Schermata+2013-06-06+alle+11.07.31.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="175" src="http://2.bp.blogspot.com/-IFs3ToozUkw/UbCH9IB63LI/AAAAAAAAFQA/OWfeqgC1nH0/s320/Schermata+2013-06-06+alle+11.07.31.png" width="320" /></a></div>Sull'App Store di OSX ho notato un buon numero di applicazioni dedicate alla <i>gestione della memoria: </i>permettono in pratica di effettuare una <i>pulizia</i>&nbsp;della RAM liberando spazi di memoria attualmente inattiva.<br />Applicazioni come <a href="https://itunes.apple.com/it/app/freememory/id460931672?mt=12" target="_blank">FreeMemory</a>, <a href="https://itunes.apple.com/it/app/flush-memory/id458040020?mt=12" target="_blank">Flush Memory</a>, <a href="https://itunes.apple.com/it/app/memory-scope/id470372671?mt=12" target="_blank">Memory Scope</a> (giusto i primi 3 risultati su AppStore) si occupano tutte di effettuare la stessa operazione (e solitamente sono a pagamento).<br /><br />Ma sono davvero necessarie e, soprattutto, è possibile avere lo stesso risultato con una soluzione <i>hand-made</i>?<br /><br /><a name='more'></a><br /><br /><h3>La pulizia della memoria è necessaria?</h3><br />Per comprendere meglio la gestione della memoria di OSX per prima cosa apriamo l’Activity Monitor , da <b>Finder </b>-&gt; <b>Applicazioni </b>-&gt;<b>Utilities</b>-&gt; <b>Monitoraggio Attività</b> e selezioniamo il tab <b>Memoria Sistema</b>.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-_LyKfiqSnMA/UbCAVbNMvdI/AAAAAAAAFPY/I-5Z8DINQxE/s1600/Schermata+2013-06-06+alle+14.26.47.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="182" src="http://3.bp.blogspot.com/-_LyKfiqSnMA/UbCAVbNMvdI/AAAAAAAAFPY/I-5Z8DINQxE/s640/Schermata+2013-06-06+alle+14.26.47.png" width="640" /></a></div><br /><br />Vedremo 4 voci:<br /><br /><b>Libera</b>: la memoria libera che nessun programma sta usando<br /><b>Wired</b>: la memoria utilizzata che non puo’ essere <i>swappata </i>(trasferita su disco)<br /><b>Attiva</b>: memoria utilizzata dal sistema e dalle applicazioni (<i>swappabile</i>)<br /><b>Inattiva</b>: il pomo della discordia<br /><br />Sulla carta, il sistema è efficiente: se si chiude un’applicazione è probabile che la si riutilizzerà in seguito e lasciandola nella memoria si diminuiscono notevolmente i tempi di riavvio.<br /><br />Se successivamente l'applicazione non viene utilizzata, OSX avvia a intervalli regolari una <i>garbage collection</i> che libera la memoria inattiva.<br /><br />Cosa succede però se ci si trova nella situazione riportata nell'immagine, con una grossa percentuale di memoria inattiva e poca memoria libera, e si avvia una applicazione <i>avida</i>&nbsp;di risorse?<br />OSX cerca di non toccare la memoria inattiva, sempre nell'ottica di fornire una perfetta <i>user experience</i>&nbsp;con le applicazioni che si avviano nel minor tempo possibile, e inizia a spostare su disco parte della memoria attiva (inizia a <i>swappare</i>). Il processo tende quindi a rallentare le applicazioni attualmente aperte che, se interessate da uno swap pesante, possono smettere di rispondere per qualche secondo e iniziare a presentare la fatidica <a href="http://en.wikipedia.org/wiki/Spinning_pinwheel" target="_blank">Spinning Pinwheel</a>.<br /><br />In alcuni casi, quindi, la pulizia della memoria inattiva potrebbe migliorare nell'immediato le prestazioni del Mac.<br /><br /><h3>E' necessario acquistare un'applicazione dedicata alla gestione della memoria?</h3><br /><b>No</b>: la funzionalità è già presente in OSX, a patto di aver installato gli strumenti di sviluppo di <a href="https://developer.apple.com/technologies/tools/" target="_blank">XCode </a>(gratuiti).<br /><br />Il comando da utilizzare è <i>purge</i>, da richiamare in una qualsiasi finestra di terminale: in pochi secondi libererà la memoria <i>inattiva</i>, trasformandola in <i>libera</i>.<br /><br />Se per alcuni può risultare scomodo aprire la finestra di terminale e digitare il comando (non tutti sono sviluppatori sempre con la console sotto mano ;-) ), è possibile realizzare un breve applescript che permette con un click di liberare la memoria, vediamo un esempio:<br /><br /><br /><script src="https://gist.github.com/andreafortuna/d23315197cf791a9a14c.js"></script> <br /><a href="http://3.bp.blogspot.com/-A4Fjt5KGHYE/UbCH0nwyknI/AAAAAAAAFP4/x_u5bDZUFaM/s1600/Schermata+2013-06-06+alle+11.07.00.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="65" src="http://3.bp.blogspot.com/-A4Fjt5KGHYE/UbCH0nwyknI/AAAAAAAAFP4/x_u5bDZUFaM/s200/Schermata+2013-06-06+alle+11.07.00.png" width="200" /></a>Lo script si occupa di leggere lo stato della memoria libera, eseguire il comando <i>purge, </i>verificare nuovamente il valore di memoria libera e presentare un box con il valore di ram recuperata.<br /><br /><h3>Trasformiamolo in una App!</h3><br /><a href="http://2.bp.blogspot.com/-IFs3ToozUkw/UbCH9IB63LI/AAAAAAAAFQA/OWfeqgC1nH0/s1600/Schermata+2013-06-06+alle+11.07.31.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="109" src="http://2.bp.blogspot.com/-IFs3ToozUkw/UbCH9IB63LI/AAAAAAAAFQA/OWfeqgC1nH0/s200/Schermata+2013-06-06+alle+11.07.31.png" width="200" /></a>Lo script appena creato può inoltre essere inglobato in un flusso di lavoro di Automator (vedi immagine) e salvato come una piccola app da lasciare sul dock a portata di mouse:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-59MBnjJCtTc/UbCF_9LxYJI/AAAAAAAAFPo/eadiNGDUdTI/s1600/Schermata+2013-06-06+alle+14.49.07.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="288" src="http://1.bp.blogspot.com/-59MBnjJCtTc/UbCF_9LxYJI/AAAAAAAAFPo/eadiNGDUdTI/s640/Schermata+2013-06-06+alle+14.49.07.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Per i pigri, ho già realizzato il pacchetto che può essere scaricato da <a href="http://demo.andreafortuna.org/FreeMemory/" target="_blank">QUESTO INDIRIZZO</a>&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><b><a href="" id="update1">UPDATE 15:24</a></b>: L'eseguibile è compatibile con <b>OSX 10.7</b> e superiori, grazie a <a href="http://hackingitalia.com/user/nicoladagostino" target="_blank">nicoladagostino</a> per la <a href="http://hackingitalia.com/comment/211/3" target="_blank">segnalazione</a> su <a href="http://hackingitalia.com/" target="_blank">Hackingitalia</a>.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Spero sia utile! ;-)</div>