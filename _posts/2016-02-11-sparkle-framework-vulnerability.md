---
layout: post
title: "Vulnerability on Sparkle framework affects a lot of Mac apps"
thumbnail: "http://www.andreafortuna.org/technology/images/sparkle-vulnerability.png"
description: "Sparkle is open source framework to include autoupdate feature in OSX apps, and a recently discovered vulnerability has made many applications using this framework susceptible to man-in-the-mirror attacks. "
keywords: Security, Sparkle, Mac, OSX, vulnerability, Simone Margaritelli, Bettercap
category: Security
tags: 
- Security
- Mac
- OSX
- Threats
- Sparkle
- Vulnerability
- Bettercap

---
{% include JB/setup %}

[Sparkle](https://sparkle-project.org/){:target="_blank"} is open source framework to include autoupdate feature in OSX apps.

![Sparkle](/technology/images/sparkle-vulnerability.png)

Is available under MIT license, and "is developed on GitHub by the Sparkle Project with the help of dozens of valued contributors".

But a [recently discovered vulnerability](https://vulnsec.com/2016/osx-apps-vulnerabilities/) has made many applications using this framework susceptible to [MITM](https://en.wikipedia.org/wiki/Man-in-the-middle_attack){:target="_blank"} attacks. 

From [ArsTechnica](http://arstechnica.com/security/2016/02/huge-number-of-mac-apps-vulnerable-to-hijacking-and-a-fix-is-elusive/){:target="_blank"}:

>The vulnerability is the result of apps that use a vulnerable version of Sparkle along with an unencrypted HTTP channel to receive data from update servers. 
It involves the way Sparkle interacts with functions built into the WebKit rendering engine to allow JavaScript execution. 
As a result, attackers with the ability to manipulate the traffic passing between the end user and the server—say, an adversary on the same Wi-Fi network—can inject malicious code into the communication. 

The attack
--

Here's a brief video showing a *proof-of-concept* attack performed against a vulnerable version of the Sequel Pro app:

<div class="video-container">
<iframe src="https://www.youtube.com/embed/16acap5hep4" frameborder="0" allowfullscreen></iframe>
</div>

The researcher [Simone Margaritelli](https://www.evilsocket.net/){:target="_blank"} has developed a technique that streamlines the attack by allowing it to work with [bettercap](https://www.bettercap.org/). 

He showed how he could exploit the vulnerability on a fully patched Mac running the latest version of the VLC Media Player: you can read the article at [this link](https://www.evilsocket.net/2016/01/30/osx-mass-pwning-using-bettercap-and-the-sparkle-updater-vulnerability/){:target="_blank"}, the *bettercap module* can be downloaded [here](https://github.com/evilsocket/bettercap-proxy-modules/blob/master/osxsparkle.rb){:target="_blank"}.


What are the affected applications?
--

The list is huge, and can be read on [sparkle's Github](https://github.com/sparkle-project/Sparkle/issues/717), among the most common there are:

- Adium
- Coda
- iTerm
- Facebook Origami
- SequelPro
- Tunnelblick
- VLC

Solutions?
--

[Radek](https://twitter.com/radekk){:target="_blank"}'s [suggestion](https://vulnsec.com/2016/osx-apps-vulnerabilities/){:target="_blank"} for developers:

>To fix and avoid RCE in your app, you need to edit Info.plist file and replace *http -> https* for *SUFeedURL* key. 
Remember to check if your server configuration supports https and you have a valid SSL certificate in place.

and

>To fully protect against this issue you need to upgrade the Sparkle Updater framework to the version 1.13.1 (http://sparkle-project.org/) which was already patched.